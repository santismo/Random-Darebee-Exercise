<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Random DAREBEE Workout</title>
<style>
  :root { --bg:#0e0e11; --panel:#16161d; --text:#e6e6eb; --muted:#9a9aaa; --accent:#7aa2ff; --err:#ff6b6b; }
  body{margin:0;min-height:100vh;display:flex;align-items:center;justify-content:center;background:var(--bg);color:var(--text);
       font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;padding:20px;}
  .card{width:min(520px,100%);background:var(--panel);border-radius:14px;padding:22px;box-shadow:0 20px 60px rgba(0,0,0,.5);}
  h1{margin:0 0 14px;font-size:1.25rem}
  select,button{width:100%;padding:12px 14px;border-radius:10px;border:1px solid rgba(255,255,255,.08);background:#111118;color:var(--text);font-size:1rem}
  button{margin-top:10px;border:none;background:var(--accent);color:#0b0b10;font-weight:700;cursor:pointer}
  button:disabled{opacity:.55;cursor:not-allowed}
  #status{margin-top:10px;color:var(--muted);font-size:.9rem;min-height:1.2em}
  #status.err{color:var(--err)}
</style>
</head>
<body>
  <div class="card">
    <h1>Random DAREBEE Workout</h1>
    <select id="cat"></select>
    <button id="go">Go</button>
    <div id="status"></div>
  </div>

<script>
const statusEl = document.getElementById("status");
const catEl = document.getElementById("cat");
const goBtn = document.getElementById("go");

function setStatus(msg, err=false){ statusEl.textContent = msg; statusEl.className = err ? "err" : ""; }

async function loadCategories(){
  const url = new URL("categories.json", window.location.href).toString();
  setStatus("Loading categories…");
  const res = await fetch(url, {cache:"no-store"});
  if(!res.ok) throw new Error(`categories.json fetch failed (HTTP ${res.status})`);
  return res.json();
}

let CATS = null;

(async () => {
  try{
    CATS = await loadCategories();
    const names = Object.keys(CATS.categories);
    if(!names.length) throw new Error("No categories found in categories.json");
    catEl.innerHTML = names.map(n => `<option value="${n}">${n}</option>`).join("");
    setStatus("Ready.");
  }catch(e){
    console.error(e);
    setStatus(e.message, true);
  }
})();

goBtn.addEventListener("click", () => {
  try{
    if(!CATS) throw new Error("Categories not loaded yet.");
    const name = catEl.value;
    const urls = CATS.categories[name]?.urls;
    if(!urls?.length) throw new Error(`No URLs in category: ${name}`);
    const pick = urls[Math.floor(Math.random() * urls.length)];
    setStatus("Redirecting…");
    window.location.href = pick;
  }catch(e){
    console.error(e);
    setStatus(e.message, true);
  }
});
</script>
</body>
</html>